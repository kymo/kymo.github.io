<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1" /> <title>SVD</title> <meta name="twitter:card" content="summary" /> <meta name="twitter:site" content="@kymo" /> <meta name="twitter:title" content="SVD" /> <meta name="twitter:description" content="奇异值分解作为一种矩阵分解的算法，广泛的应用于数据分析、信号处理、模式识别、图片压缩、天气预测以及潜在概率语义分析等应用。其实质是通过分解矩阵，找到矩阵行列之间的某种潜在关系。如在推荐系统中利用SVD分解用户-商品的评分矩阵，便可以得到用户和商品之间的关联。"> <meta name="description" content="奇异值分解作为一种矩阵分解的算法，广泛的应用于数据分析、信号处理、模式识别、图片压缩、天气预测以及潜在概率语义分析等应用。其实质是通过分解矩阵，找到矩阵行列之间的某种潜在关系。如在推荐系统中利用SVD分解用户-商品的评分矩阵，便可以得到用户和商品之间的关联。"> <link rel="icon" href="/assets/favicon.png"> <link rel="apple-touch-icon" href="/assets/touch-icon.png"> <link rel="stylesheet" href="//code.cdn.mozilla.net/fonts/fira.css"> <link rel="stylesheet" href="/assets/core.css"> <link rel="canonical" href="/machinelearning/2016/04/02/SVD.html"> <link rel="alternate" type="application/atom+xml" title="Aron's blog" href="/feed.xml" /> <script type="text/x-mathjax-config"> MathJax.Hub.Config({ tex2jax: { inlineMath: [ ['$', '$'], ['\\(', '\\)'] ], displayMath: [ ['$$', '$$'], ["\\[", "\\]"] ], processEscapes: true }, "HTML-CSS": { linebreaks: { automatic: true }, availableFonts: ["TeX"], scale: 100 }}); </script> <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> </head> <body> <aside class="logo"> <a href="/"> <img src="/public/image/avatar.jpg" class="gravatar"> </a> <span class="logo-prompt">Back to Home</span> </aside> <main> <noscript> <style> article .footnotes { display: block; } </style> </noscript> <article> <div style='float:left;'> <div class="center"> <h1>SVD</h1> <time>April 2, 2016</time> </div> <div class="divider"></div> <p>奇异值分解作为一种矩阵分解的算法，广泛的应用于数据分析、信号处理、模式识别、图片压缩、天气预测以及潜在概率语义分析等应用。其实质是通过分解矩阵，找到矩阵行列之间的某种潜在关系。如在推荐系统中利用SVD分解用户-商品的评分矩阵，便可以得到用户和商品之间的关联。</p> <h3 id="section">特征值分解</h3> <p>一般矩阵乘以某个向量，代表着对该向量进行某种线性变换：拉伸、平移以及旋转，在计算机图形学中经常对三维场景的物体在各种不同的坐标系下进行变换也利用了该种性质，直接利用物体的三维坐标乘以变换矩阵即可实现。如果对向量的线性变换仅仅只是对向量进行了缩放，那么这种情况便是特征值分解，既有<script type="math/tex">Ax=\lambda x</script>. 特征值分解的物理意义在不同的应用场景下有不同的解释。不过一般都是对对称矩阵<script type="math/tex">A</script>进行分解，得到一组正交的特征向量作为正交基，使得矩阵<script type="math/tex">A</script>能够被投射到以该正交基为基底的空间中，特征值则表示在不同的正交基下的投射距离，特征值越大说明矩阵在对应的特征向量上的方差越大，功率越大，信息熵也越大，在PCA(principal component analysis)中，即可以利用特征值分解，获取最重要的K个成分对数据进行降维，保证在数据规模可控的情况下获得足够的信息量。</p> <h3 id="section-1">奇异值分解</h3> <p>奇异值分解可以认为是特征值分解的扩充，即解决对于矩阵<script type="math/tex">A(m \times n)</script>能否在原始空间<script type="math/tex">R^n</script>中找到一组正交基<script type="math/tex">(v_1, v_2, v_3, \cdot \cdot \cdot , v_n)</script>，使得经过该线性变换矩阵投射得新的空间<script type="math/tex">R^m</script>中的向量仍然正交的问题，即当<script type="math/tex">i!=j ，v_i^T \times v_j = 0</script>时，<script type="math/tex">(Av_i,Av_j) = 0</script>.</p> <p>对于矩阵<script type="math/tex">A^TA(n \times n)</script>，该矩阵为对称矩阵，且有<script type="math/tex">r(A^TA)=r</script>，则可以通过特征值分解得到对应的一组正交基<script type="math/tex">(v_1, v_2, v_3, \cdot \cdot \cdot , v_r)</script>，使得<script type="math/tex">A^TAv_i=\lambda v_i</script>. 对于经过<script type="math/tex">A</script>线性变化投射到新的空间的向量<script type="math/tex">Av_i</script>，容易推知当<script type="math/tex">i!=j</script>时，<script type="math/tex">(Av_i,Av_j)</script>=0. 从而可以得到投射之后的新的一组正交基<script type="math/tex">U</script>为<script type="math/tex">(Av_1,Av_2, \cdot \cdot \cdot Av_r)</script>，对其进行标准化，有</p> <script type="math/tex; mode=display">u_i=\frac{Av_i}{\mid Av_i\mid} =\frac{1}{\sqrt {\lambda_i}} Av_i => Av_i = \sqrt {\lambda_i}u_i = \delta_i u_i</script> <p>则有</p> <p>$A(v_1, v_2, v_3, \cdot \cdot \cdot, v_r) = (\delta_1 u_1 , \delta_2 u_2 , \delta_3 u_3, \cdot \cdot \cdot , \delta_r u_r) = (u_1, u_2, \cdot \cdot \cdot, u_r) \times [ \begin {matrix} \delta_1, \cdot \cdot \cdot, 0 \\ 0, \cdot \cdot \cdot, 0 \\ 0, \cdot \cdot \cdot, \delta_r \end {matrix} ] $</p> <p>即<script type="math/tex">AV = U\Sigma => AVV^T = U\Sigma V^T => A = U\Sigma V^T (VV^T=E)</script> ，其中，$\Sigma$的对角元素为特征值的开平方，表示<script type="math/tex">V</script>向量经过<script type="math/tex">A</script>方阵变换之后与<script type="math/tex">U</script>向量之间的缩放对应关系，此时<script type="math/tex">U</script>矩阵大小为<script type="math/tex">m \times r</script>，<script type="math/tex">V</script>矩阵大小为<script type="math/tex">n \times r</script>，也可以将<script type="math/tex">U</script>扩充为<script type="math/tex">m \times m</script>，<script type="math/tex">V</script>扩充为 <script type="math/tex">n \times n</script>，此时<script type="math/tex">\Sigma</script>大小则为<script type="math/tex">m \times n</script>，即在原来的基础之上增加若干个0行和0列.</p> <p>从另外一个角度，对于任意矩阵<script type="math/tex">A</script>，可以分解为<script type="math/tex">A= U\Sigma V^T</script>的形式，于是可以得到：</p> <script type="math/tex; mode=display">AA^T=U\Sigma V^T V\Sigma^TU^T = U\Sigma \Sigma^TU^T</script> <script type="math/tex; mode=display">A^TA= V\Sigma^TU^T U\Sigma V^T = V\Sigma \Sigma^TV^T</script> <p>所以，<script type="math/tex">U</script>可以看成是对矩阵<script type="math/tex">AA^T</script>进行特征值分解得到的正交基，<script type="math/tex">V</script>可以看成是对矩阵<script type="math/tex">A^TA</script>进行分解得到的正交基。</p> <h3 id="svd-lsa">SVD 在LSA中的应用</h3> <p>奇异值分解在诸多方面都有十分成功的应用，在数据压缩中，可以通过将原始的矩阵进行奇异值分解，去除奇异值较小的部分得到低阶近似，从而实现对数据的降维；在语义分析中，通过对构造的文档-词汇矩阵<script type="math/tex">D</script>进行奇异值分解<script type="math/tex">D=U \Sigma V^T</script></p> <script type="math/tex; mode=display">D = [ \begin{array}{ccc} x_{1,1} , \cdot \cdot \cdot , x_{1,n} \\\ \cdot \cdot \cdot , \cdot \cdot \cdot , \cdot \cdot \cdot \\\ x_{m,1} , \cdot \cdot \cdot , x_{m,n} \end{array} ] = [t_1 , t_2, \cdot \cdot \cdot , t_n]^T = [d_1 , d_2, \cdot \cdot \cdot , d_m]</script> <p>其中，<script type="math/tex">t_i^T = (x_{i,1}, x_{i,2}, \cdot \cdot \cdot , x_{i,n}) , d_j^T = (x_{1,j}, x_{2,j}, \cdot \cdot \cdot , x_{m,j})</script>。</p> <p>进行SVD分解之后</p> <script type="math/tex; mode=display">D=U\Sigma V^T = (u_1, u_2, \cdot \cdot \cdot, u_r) \times [ \begin {matrix} \delta_1, \cdot \cdot \cdot, 0 \\\ 0, \cdot \cdot \cdot, 0 \\\ 0, \cdot \cdot \cdot, \delta_r \end {matrix} ] \times (v_1, v_2, \cdot \cdot \cdot , v_r)^T</script> <p>随后进行k-阶近似，取最大的k个奇异值<script type="math/tex">\Sigma_k</script>以及对应的奇异向量<script type="math/tex">U_k,V_k</script>，便可以对<script type="math/tex">D</script>进行降维，将词汇-文档空间映射到语义空间中去，此时k值可以认为是语义空间中的主题数，<script type="math/tex">U_k</script>可以看做在该语义空间中，文档上的主题分布，而<script type="math/tex">V_k</script>则可以看成是主题上的词汇分布。</p> <script type="math/tex; mode=display">D_k = U_k \Sigma_k V_k^T = (u_1, u_2, \cdot \cdot \cdot, u_k) \times [ \begin {matrix} \delta_1, \cdot \cdot \cdot, 0 \\\ 0, \cdot \cdot \cdot, 0 \\\ 0, \cdot \cdot \cdot, \delta_k \end {matrix} ] \times (v_1, v_2, \cdot \cdot \cdot , v_k)^T</script> <p>此时，<script type="math/tex">d_j^T = (v_{1,j}，v_{2,j}, \cdot \cdot \cdot ,v_{k,j})</script>, <script type="math/tex">t_i^T = (u_{1,j}，u_{2,j}, \cdot \cdot \cdot ,u_{k,j})</script> 此时D仍然是<script type="math/tex">m \times n</script>，得到对词汇-文档原始矩阵的奇异值分解结果之后，变可以完成包括词汇相似度计算、文档相似度计算等任务。</p> <h4 id="pq">1. 词汇相似度计算，计算语料中的两个词汇<script type="math/tex">p</script>，<script type="math/tex">q</script>的语义相似度</h4> <p>分别计算<script type="math/tex">\Sigma_k \times t_i</script>以及<script type="math/tex">\Sigma_k \times t_j</script>(i和j为词汇p,q对应的ID)，可以得到两个列向量，然后通过某种距离计算方式可以得到两者的语义距离.</p> <h4 id="p-q">2. 文档相似度计算，计算语料中的两篇文档<script type="math/tex">p</script>, <script type="math/tex">q</script>的语义相似度</h4> <p>分别计算<script type="math/tex">\Sigma_k \times d_i</script>以及<script type="math/tex">\Sigma_k \times d_j</script>(i和j为词汇p,q对应的ID)，可以得到两个列向量，然后通过某种距离计算方式可以得到两者的语义距离.</p> <h4 id="section-2">3. 分本聚类</h4> <p>低阶降维之后可以的到语义空间的文档特征，从而可以利用一些无监督的聚类算法进行文档聚类，当然也可以作为分档分类的特征。</p> <h4 id="lsa-">4. LSA 缺点</h4> <ul> <li>新生成的矩阵的解释性比较差.造成这种难以解释的结果是因为SVD只是一种数学变换，并无法对应成现实中的概念。</li> <li>LSA无法扑捉一词多以的现象。在原始词-向量矩阵中，每个文档的每个词只能有一个含义。比如同一篇文章中的“The Chair of Board”和”the chair maker”的chair会被认为一样。在语义空间中，含有一词多意现象的词其向量会呈现多个语义的平均。相应的，如果有其中一个含义出现的特别频繁，则语义向量会向其倾斜。</li> <li>LSA具有词袋模型的缺点，即在一篇文章，或者一个句子中忽略词语的先后顺序。</li> <li>LSA的概率模型假设文档和词的分布是服从联合正态分布的，但从观测数据来看是服从泊松分布的。因此LSA算法的一个改进PLSA使用了多项分布，其效果要好于LSA。</li> </ul> <h3 id="section-3">参考资料</h3> <ul> <li><a href="http://www.puffinwarellc.com/index.php/news-and-articles/articles/30-singular-value-decomposition-tutorial.html?showall=1">Singular Value Decomposition (SVD) Tutorial</a></li> <li><a href="http://blog.sciencenet.cn/blog-696950-699432.html">奇异值分解(SVD) — 几何意义</a></li> <li><a href="https://www.zhihu.com/question/21874816">如何理解矩阵特征值？</a></li> <li><a href="http://charlesx.top/2016/03/Singularly-Valuable-Decomposition/">漫谈奇异值分解</a></li> <li><a href="http://www.math.washington.edu/~morrow/464_14/svd.pdf">Dan Kalman. A singularly valuable decomposition: The SVD of a matrix[J]. College Mathematics Journal, 1996, 27(1):2–23.</a></li> <li><a href="http://blog.csdn.net/roger__wong/article/details/41175967">LSA潜在语义分析</a></li> </ul> </div> <div id='article_list_p st' style='float:right; width:250px; height:100%; position:absolute; right:10px; top:300px; font-size:12px;'> <h2>文章列表</h2></hr> <a href="/machinelearning/2016/08/16/CRF.html">CRF 笔记</a></br> <a href="/machinelearning/2016/08/16/PaperReadingNote.html">论文阅读笔记</a></br> <a href="/machinelearning/2016/04/03/EnsembleLearningMethods.html">Ensemble Learning Methods</a></br> <a href="/naturallanguageprocessing/2016/04/02/pLSA.html">Probability Latent Semantic Analysis</a></br> <a href="/machinelearning/2016/04/02/SVM.html">Support Vector Machine</a></br> <a href="/machinelearning/2016/04/02/SVD.html">SVD</a></br> <a href="/machinelearning/2016/04/02/RandomForests.html">Random Forest</a></br> <a href="/machinelearning/2016/04/02/HMM.html">HMM</a></br> <a href="/machinelearning/2016/04/02/ESL_Notes.html">ESL Notes</a></br> <a href="/algorithm/2016/04/02/DP.html">Dynamic Programming</a></br> <a href="/algorithm/2016/04/02/Bit.html">Bit Manupulation</a></br> <h2> Tags </h2><hr> <span style='margin:2px;background:#ddd;'>CRF </div> <span style='margin:2px;background:#ddd;'>NLP </div> </div> </article> <div class="ds-thread" data-thread-key="/machinelearning/2016/04/02/SVD" data-title="SVD" data-url="//machinelearning/2016/04/02/SVD.html" style='width:666px;margin:0px auto'></div> <!-- 多说评论框 end --> <!-- 多说公共JS代码 start (一个网页只需插入一次) --> <script type="text/javascript"> var duoshuoQuery = {short_name:"aron"}; (function() { var ds = document.createElement('script'); ds.type = 'text/javascript';ds.async = true; ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js'; ds.charset = 'UTF-8'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ds); })(); </script> <!-- 多说公共JS代码 end --> <div class="back"> <a href="/">Back</a> </div> </main> </body> </html>