<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1" /> <title>sub: 轻量应用服务器</title> <meta name="twitter:card" content="summary" /> <meta name="twitter:site" content="@kymo" /> <meta name="twitter:title" content="sub: 轻量应用服务器" /> <meta name="twitter:description" content="sub是正在开发的一种轻量的应用服务器, 项目地址: sub"> <meta name="description" content="sub是正在开发的一种轻量的应用服务器, 项目地址: sub"> <link rel="icon" href="/assets/favicon.png"> <link rel="apple-touch-icon" href="/assets/touch-icon.png"> <link rel="stylesheet" href="//code.cdn.mozilla.net/fonts/fira.css"> <link rel="stylesheet" href="/assets/core.css"> <link rel="canonical" href="/machinelearning/2016/04/20/SUB.html"> <link rel="alternate" type="application/atom+xml" title="Aron blog" href="/feed.xml" /> <!-- mathjax config similar to math.stackexchange --> <script type="text/x-mathjax-config"> MathJax.Hub.Config({"HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"], linebreaks: { automatic:true }, EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50) }, tex2jax: { inlineMath: [ ["$", "$"], ["\\\\(","\\\\)"] ], displayMath: [ ["$$","$$"], ["\\[", "\\]"] ], processEscapes: true, ignoreClass: "tex2jax_ignore|dno" }, TeX: { noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } } }, messageStyle: "none" }); </script> <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> </head> <body> <aside class="logo"> <a href="/"> <img src="/public/image/avatar.jpg" class="gravatar"> </a> <span class="logo-prompt">Back to Home</span> </aside> <main> <noscript> <style> article .footnotes { display: block; } </style> </noscript> <article> <div style='float:left;'> <div class="center"> <h1>sub: 轻量应用服务器</h1> <time>April 20, 2016</time> </div> <div class="divider"></div> <p>sub是正在开发的一种轻量的应用服务器, 项目地址: <a href="https://github.com/kymo/sub">sub</a></p> <h1 id="sub">SUB</h1> <h2 id="socket">SOCKET</h2> <h3 id="设置为非阻塞模式可以设置selecteoll-io模型将">设置为非阻塞模式，可以设置SELECT/EOLL IO模型.将</h3> <p>Read, Write, Accept作为Reactor函数传递给IO模型</p> <h3 id="有新的连接发过来数据利用解析任务解析该任务然">有新的连接发过来数据，利用解析任务解析该任务，然</h3> <p>后将解析出来的数据按照类型生成新的对应任务丢到队 列中. 任务处理完成之后，设置该FD为写，并将写的容 一并返回.</p> <h2 id="io">IO</h2> <h3 id="select">Select</h3> <h4 id="使用read_set和write_set处理连接和读写并接受">使用read_set和write_set处理连接和读写，并接受</h4> <p>server 传递过来的回调函数指针作为事件处理方法</p> <h3 id="epoll">Epoll</h3> <h4 id="todo">TODO</h4> <h2 id="taskmgr">TaskMgr</h2> <h3 id="task">task</h3> <h4 id="对任务的封装单个任务会有自己运行的回掉函数以">对任务的封装，单个任务会有自己运行的回掉函数，以</h4> <p>及运行时的参数空间,运行run完成之后，这个run会将 数据写回缓冲区. 然后调用call_back函数，将结果写 会fd,不同的任务会继承该task, 计算任务可以由用户指 定运行的回调函数.</p> <h3 id="task_handler">task_handler</h3> <h4 id="作为线程池的thead_handler每次都会从任务队列">作为线程池的thead_handler，每次都会从任务队列</h4> <p>中取一个任务进行运行</p> <h2 id="threadmgr">ThreadMgr</h2> <h3 id="thread">thread</h3> <h4 id="对线程的封装线程运行函数由thread_handler指定">对线程的封装，线程运行函数由thread_handler指定</h4> <h3 id="thread_handler">thread_handler</h3> <h4 id="线程真正的实现逻辑不同类型的线程有不同的handl">线程真正的实现逻辑，不同类型的线程有不同的handl</h4> <p>er去处理，对于线程池中的handler会不断的从taskM gr中取task进行处理</p> <h3 id="thread_pool">thread_pool</h3> <h4 id="线程池模型根据配置中的线程数启动每个线程分配一">线程池模型,根据配置中的线程数启动每个线程分配一</h4> <p>个handler</p> <h2 id="pluginmgr">PluginMgr</h2> <h2 id="dictmgr">DictMgr</h2> <h2 id="configmgr">ConfigMgr</h2> <h2 id="memorymgr">MemoryMgr</h2> </div> <div id='article_list_p st' style='float:right; width:250px; height:100%; position:absolute; right:10px; top:300px; font-size:12px;'> </div> </article> <div class="ds-thread" data-thread-key="/machinelearning/2016/04/20/SUB" data-title="sub: 轻量应用服务器" data-url="//machinelearning/2016/04/20/SUB.html" style='width:766px;margin:0px auto'></div> <!-- 多说评论框 end --> <!-- 多说公共JS代码 start (一个网页只需插入一次) --> <script type="text/javascript"> var duoshuoQuery = {short_name:"aron"}; (function() { var ds = document.createElement('script'); ds.type = 'text/javascript';ds.async = true; ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js'; ds.charset = 'UTF-8'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ds); })(); </script> <!-- 多说公共JS代码 end --> <div class="back"> <a href="/">Back</a> </div> </main> </body> </html>